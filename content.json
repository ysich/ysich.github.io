{"meta":{"title":"ysich'Blog","subtitle":"","description":"","author":"ysich","url":"http://ysich.github.io","root":"/"},"pages":[{"title":"ä¸‰åå…­åˆ†çƒ­","date":"2023-01-16T12:19:47.112Z","updated":"2023-01-16T12:19:47.112Z","comments":false,"path":"about/index.html","permalink":"http://ysich.github.io/about/index.html","excerpt":"","text":""}],"posts":[{"title":"å…³äºCallBack","slug":"å…³äºCallBack","date":"2023-01-31T02:36:16.000Z","updated":"2023-01-31T02:37:19.200Z","comments":true,"path":"2023/01/31/å…³äºCallBack/","link":"","permalink":"http://ysich.github.io/2023/01/31/%E5%85%B3%E4%BA%8ECallBack/","excerpt":"","text":"å…³äºCallBackCallbackæé«˜cpuåˆ©ç”¨ç‡ä¸ä¼šé€ æˆé˜»å¡ã€‚åšä¸€ä»¶äº‹ä¸ä¼šç­‰å¾…ï¼Œç­‰éœ€è¦æ—¶å†call backå¤„ åº”ç”¨åœºæ™¯ DMAæ§åˆ¶å™¨ cpuåšæ•°æ®å¤åˆ¶æ—¶ä¼šé˜»å¡cpuï¼Œcpu é€šçŸ¥ç¡¬ä»¶è¿›è¡Œå¤åˆ¶å®Œæˆåé€šçŸ¥å›æ¥ã€‚ä¸ä¼šé˜»å¡æ•´ä¸ªcpu ç½‘ç»œå¤šè·¯å¤ç”¨ Socketè¯»å†™è¿‡ç¨‹ä¸­ï¼Œç­‰å¾…æ•°æ®å‘é€æˆ–æ¥æ”¶è¿‡ç¨‹cpuçš„é˜»å¡ã€‚ç­‰æ•°æ®è¿‡æ¥åå†è¿›è¡Œé€šçŸ¥ã€‚ å¤šçº¿ç¨‹ æ—¶é—´ æ¯”å¦‚ç­‰å¾…5ç§’åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œä¸éœ€è¦é˜»å¡çº¿ç¨‹5ç§’åå†æ‰§è¡Œã€‚ CallBackå†å²å‡½æ•°æŒ‡é’ˆCè¯­è¨€å†…é€šè¿‡å‡½æ•°æŒ‡é’ˆçš„æ–¹å¼ï¼Œåœ¨callback åç”¨æŒ‡é’ˆæ‰§è¡Œå‡½æ•°ï¼Œä½†æ˜¯ä¸æ–¹ä¾¿åŒæ­¥ä¸Šä¸‹æ–‡ä¸”ç±»å‹ä¸å®‰å…¨ï¼ˆå¯ä»¥ä¼ é€’ä»»æ„æŒ‡é’ˆï¼‰ å‡½æ•°å¯¹è±¡C++é€šè¿‡å‡½æ•°å¯¹è±¡çš„æ–¹å¼ï¼Œç±»å‹å®‰å…¨ã€æ„é€ æ—¶ä¼ é€’å‡½æ•°æŒ‡é’ˆã€æ„é€ æ—¶ä¼ é€’ä¸Šä¸‹æ–‡ã€ç»‘å®šä¸Šä¸‹æ–‡ å°†ä¸Šä¸‹æ–‡å’Œå›è°ƒå‡½æ•°å°è£…æˆä¸€ä¸ªç±»ï¼ˆé—­åŒ…ï¼‰ï¼Œåšåˆ°å»¶è¿Ÿè°ƒç”¨ã€‚é—­åŒ…æ¯”è¾ƒç¹çï¼Œå½“éœ€è¦ä¸Šä¸‹æ–‡å¯¹è±¡ç±»å‹ä¸æ»¡è¶³å·²æœ‰æ‰©å±•çš„é—­åŒ…æ”¯æŒçš„ç±»å‹æ—¶å°±è¦è¿›è¡Œ é—­åŒ…ç±»å‹çš„æ‰©å±•ã€‚ è°·æ­Œçš„NewCallBackä¸Šä¸‹æ–‡åªèƒ½ç»‘å®šå‰é¢çš„å‚æ•°ä¸èƒ½ç»‘å®šåé¢çš„å‚æ•°ã€è¿”å›çš„æ˜¯æŒ‡é’ˆï¼ˆæœ¬è´¨æ˜¯newä¸€ä¸ªå‡½æ•°å¯¹è±¡æ‰§è¡Œï¼‰å¦‚æœæ²¡æœ‰è°ƒç”¨ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼ˆè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆåŒ…è£¹ï¼‰ Callback Hellï¼ˆå›è°ƒåœ°ç‹±ï¼‰åœ¨å¤„ç†å›è°ƒæ—¶ï¼Œæˆ‘ä»¬çš„é€»è¾‘ä¼šè¢«æˆªæˆä¸¤æ®µï¼Œä¸€æ®µæ˜¯å‘èµ·callback ä¸€æ®µæ˜¯å“åº”callback ã€‚åœ¨Callbackè°ƒç”¨Callbackçš„è¿‡ç¨‹ä¸­ï¼Œä»£ç ç›¸åº”ä¼šåƒæ³¢æµªä¸€æ ·è¶Šæ¨è¶Šè¿œã€‚ æ˜“å‡ºé”™ã€éš¾ä¿®æ”¹ã€‚åœ¨callback ä¸­éš¾æ’å…¥ã€‚ async await TaskæŠŠint Func() (å›è°ƒ) è½¬æˆawait Func() åœ¨C#ä¸­é€šè¿‡è½¬æ¢å·¥å…·TaskCompletionSource è½¬æ¢ ETTask ç®€åŒ–çš„Task ç”Ÿæˆä»£ç ç®€å• (.Net Reflector å¯ä»¥.net stand 2.0åç¼–è¯‘) è§£å†³äº†GCé—®é¢˜ Task ä½¿ç”¨TaskCompletionSourceå·¥å…·ç±»è½¬æ¢æˆawait Func æ—¶ä¼šnew å·¥å…·ç±» ETTaskåœ¨ç¡®ä¿å®‰å…¨çš„æ—¶å€™ä½¿ç”¨æ± æ¶ˆé™¤gcï¼ŒSet Result (true)æ—¶å›æ”¶ TaskCompletionSourceå’ŒTaskåˆå¹¶ ä¸æä¾›å¤šçº¿ç¨‹å¤„ç† å¹¶è¡ŒETæä¾›WaitAll WaitAnyï¼Œç±»æ¯”çº¿ç¨‹åŒæ­¥barrier å½“å¤šä¸ªå›è°ƒåŒæ—¶å‘èµ·ï¼Œç­‰æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œå†å¾€ä¸‹æ‰§è¡Œ åœºæ™¯ï¼š åˆ‡æ¢åœºæ™¯èµ„æº,ä¸éœ€è¦ä¸€ä¸ªä¸ªåŠ è½½ï¼Œå¯ä»¥åŒæ—¶åŠ è½½ï¼Œç­‰æ‰€æœ‰åŠ è½½å®Œå†å¾€ä¸‹æ‰§è¡Œã€‚ æœºå™¨äººç™»å½•50ä¸ªï¼Œä¸éœ€è¦ä¸€ä¸ªä¸ªç™»å½•ã€‚ åç¨‹é”åº”ç”¨åœºæ™¯ï¼š ä¸¤ä¸ªé€»è¾‘åŒæ—¶åŠ è½½åŒä¸€ä¸ªabåŒ… æœåŠ¡å™¨ç©å®¶å¼‚æ­¥åŠ è½½å¤„ç†åˆ°ä¸€åŠï¼Œè¿™æ—¶æ”¶åˆ°ä¸‹çº¿æ¶ˆæ¯ã€‚ å®ç°ï¼š CoroutineComponentå®ç°æ€è·¯ï¼š åŒä¸€ç§é”ï¼ŒåŒä¸€ä¸ªkeyæ”¾å…¥åŒä¸€ä¸ªé˜Ÿåˆ— ä¸€ä¸ªåç¨‹æ‰§è¡Œå®Œåä»è‡ªå·±é˜Ÿåˆ—ä¸­å–å‡ºä¸‹ä¸€ä¸ªæ‰§è¡Œ é—®é¢˜: åç¨‹æ‰§è¡Œå–å‡ºä¸‹ä¸€ä¸ªæ‰§è¡Œæ—¶ï¼Œå¦‚æœæ¶ˆæ¯å¤„ç†ä¸è¿‡æ¥ä¼šäº§ç”Ÿé˜Ÿåˆ—å†…çš„å¤„ç†é€»è¾‘çš„å †ç§¯ã€‚é˜Ÿåˆ—å¾ˆå¤šæ—¶ï¼Œå †æ ˆçš„å±‚çº§ä¹Ÿä¼šå¾ˆå¤š(å› ä¸ºé€å±‚è°ƒç”¨)ï¼Œå¯¼è‡´å †æ ˆçˆ†æ‰ã€‚ æ”¹è¿›ï¼š å–å‡ºä¸‹ä¸€ä¸ªæ‰§è¡Œæ—¶ï¼Œä¸ç›´æ¥æ‰§è¡Œè€Œæ˜¯æ”¾å…¥updateä¸­æ‰§è¡Œã€‚ é—®é¢˜ï¼š åç¨‹é”æ­»é”æƒ…å†µï¼Œawaitäº’ç›¸ç­‰ï¼Œæ°¸è¿œç­‰ä¸åˆ° æ”¹è¿›ï¼š ETåç¨‹é”æ·»åŠ æ—¶é—´é™åˆ¶ï¼Œæ—¶é—´åˆ°äº†è§£é”(è¶…æ—¶æœºåˆ¶)ã€‚","categories":[{"name":"æ¡†æ¶ç¯‡","slug":"æ¡†æ¶ç¯‡","permalink":"http://ysich.github.io/categories/%E6%A1%86%E6%9E%B6%E7%AF%87/"}],"tags":[{"name":"CallBack","slug":"CallBack","permalink":"http://ysich.github.io/tags/CallBack/"}]},{"title":"ManagerOfManager","slug":"ManagerOfManager","date":"2023-01-17T06:14:51.000Z","updated":"2023-01-17T08:48:13.113Z","comments":true,"path":"2023/01/17/ManagerOfManager/","link":"","permalink":"http://ysich.github.io/2023/01/17/ManagerOfManager/","excerpt":"","text":"æ¡†æ¶æ­å»ºéšç¬”ç‰ˆæœ¬å·ä½¿â½¤ç‰ˆæœ¬å·å‘½åçš„â½‚ä»¶æ ¼å¼ä¸º: Framework_vX.Y.Z X æ˜¯ä¸»ç‰ˆæœ¬å·ï¼Œâ½¤äºä¸å‘å‰å…¼å®¹çš„æ›´æ–°ã€‚ Y æ˜¯ä¸­é—´ç‰ˆæœ¬ï¼Œâ½¤äºå¯å‘å‰å…¼å®¹çš„åŠŸèƒ½æ€§æ›´æ–°ã€‚ Z æ˜¯â¼©ç‰ˆæœ¬å·ï¼Œâ½¤äºåŠŸèƒ½å®Œå–„å’Œ bug ä¿®å¤çš„æ›´æ–° â¼€èˆ¬éƒ½æ˜¯ä» v0.1.1 è¿™ä¸ªç‰ˆæœ¬å¼€å§‹å‘å¸ƒçš„ï¼Œä½†æ˜¯è¿™ä¸ªç‰ˆæœ¬å‘¢å«åš mvp ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æœ€â¼©å¯éªŒè¯ç‰ˆæœ¬ã€‚åç»­å‘å¸ƒç‰ˆæœ¬éƒ½éœ€è¦å‘å‰å…¼å®¹ Obsolete æ ‡ç­¾ä½¿ç”¨Obsoleteæ ‡ç­¾æ ‡è®°æ–¹æ³•å·²å¼ƒç”¨ï¼Œä½¿ç”¨å…¶ä»–æ–¹æ³•ã€‚ æ·»åŠ å¼ƒç”¨æ ‡ç­¾åä¼šæŠ¥è­¦æŠ¥æé†’ 12345[Obsolete(\"æ–¹æ³•å·²è¿‡æ—¶ï¼Œè¯·ä½¿ç”¨xxæ–¹æ³•\")]public static void OpenInFolder(string folderPath){ Application.OpenURL(\"file://\" + folderPath);} Partialå…³é”®å­—å½“ç±»åç»­å¯èƒ½å¢é•¿çš„æ—¶å€™ä½¿ç”¨ï¼Œå„ä¸ªéƒ¨åˆ†ç±»éœ€è¦ç”¨ç›¸åŒçš„è®¿é—®æƒé™ã€‚è€Œä¸”æ¯ä¸ªéƒ¨åˆ†ç±»éƒ½éœ€è¦åŠ partialå…³é”®å­—ã€‚ æ–¹æ³•ç»“æ„é‡å¤ è§£å†³æ–¹æ¡ˆå½“ä¸€ä¸ªæ–¹æ³•çš„çš„å‚æ•°ç±»å‹ä¸åŒæ—¶ï¼Œå¦‚æœæœ‰å…±åŒçˆ¶ç±»å¯ä»¥å°†ç±»å‹è®¾ç½®ä¸ºçˆ¶ç±»ï¼Œå­ç±»å¯ä»¥è¿›è¡Œä½¿ç”¨ 123456789101112public static int GetRandomValueFrom(int[] values){ return values[Random.Range(0, values.Length)];}public static float GetRandomValueFrom(float[] values){ return values[Random.Range(0, values.Length)];}public static string GetRandomValueFrom(string[] values){ return values[Random.Range(0, values.Length)];} å¯ä»¥å°†ç±»å‹è®¾ç½®ä¸ºobject 1234public static object GetRandomValueFrom(object[] values){ return values[Random.Range(0, values.Length)];} æ³›å‹å®ç°ç»“æ„å¤ç”¨ä½¿ç”¨æ³›å‹å®ç°æ–¹æ³•å¤ç”¨ 1234public static T GetRandomValueFrom&lt;T&gt;(params T[] values){ return values[Random.Range(0, values.Length)];} paramså…³é”®å­—ä¿®é¥°å½¢å‚å¿…é¡»ä¸ºä¸€ç»´æ•°ç»„ï¼Œå¹¶ä¸”æ–¹æ³•å£°æ˜åªèƒ½æœ‰ä¸€ä¸ªparamsï¼Œå¦‚æœä¸æ˜¯ä¸€ç»´æ•°ç»„ç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚ ä½¿ç”¨ params å‚æ•°è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä¼ å…¥ï¼š æ•°ç»„å…ƒç´ ç±»å‹çš„å‚æ•°çš„é€—å·åˆ†éš”åˆ—è¡¨ã€‚ æŒ‡å®šç±»å‹çš„å‚æ•°çš„æ•°ç»„ã€‚ æ— å‚æ•°ã€‚ å¦‚æœæœªå‘é€ä»»ä½•å‚æ•°ï¼Œåˆ™ params åˆ—è¡¨çš„é•¿åº¦ä¸ºé›¶ã€‚ 12345678910//æ•°ç»„å…ƒç´ ç±»å‹çš„å‚æ•°çš„é€—å·åˆ†éš”åˆ—è¡¨public void Get(){ GetRandomValueFrom&lt;int&gt;(1, 2, 3);}//æ— å‚æ•°public void Get(){ GetRandomValueFrom&lt;int&gt;();} æ¶ˆæ¯æœºåˆ¶Unityå†…ç½®æ¶ˆæ¯æœºåˆ¶æ–¹æ³•è°ƒç”¨ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¯èƒ½ç”¨åˆ°åå°„ï¼Œå°½é‡ä¸ç”¨ã€‚ 1this.SendMessageUpward(\"MethedName\"); é€šè¿‡å§”æ‰˜é€šçŸ¥Aæ³¨å†Œç‰¹å®šæ–¹æ³•ï¼ŒBå£°æ˜å§”æ‰˜ã€‚å½“Bæƒ³è°ƒç”¨Açš„æ–¹æ³•æ—¶ï¼Œé€šè¿‡å§”æ‰˜é€šçŸ¥ã€‚ æ¶ˆæ¯æœºåˆ¶æä¾›çš„åŠŸèƒ½ æ³¨å†Œäº‹ä»¶ æ³¨é”€äº‹ä»¶ å‘é€äº‹ä»¶ 123MsgDispatcher.Register(\"æ¶ˆæ¯å\",(obj)=&gt;{ /* å¤„ç†æ¶ˆæ¯ */ });MsgDispatcher.Send(\"æ¶ˆæ¯å\",\"æ¶ˆæ¯å†…å®¹\");MsgDispatcher.UnRegister(\"æ¶ˆæ¯å\"); new Classçš„ä¼˜åŒ–å½“ä¸€ä¸ªclassä½œä¸ºå­˜å‚¨æ•°æ®æ—¶ï¼Œä¸ºäº†å‡å°‘newçš„æ¬¡æ•°å¯ä»¥åšä¸€ä¸ªå¯¹è±¡æ± è¿›è¡Œå­˜å‚¨ 123456789101112131415161718192021222324252627282930313233private class MsgRecord{ //ç§æœ‰æ„é€ å‡½æ•°åï¼Œclassæ— æ³•è¢«new private MsgRecord() { } //å¯¹è±¡æ±  static Stack&lt;MsgRecord&gt; mMsgRecordPool = new Stack&lt;MsgRecord&gt;(); //åˆ›å»ºå¯¹è±¡ public static MsgRecord Allocate(string msgName, Action&lt;object&gt; onMsgReceived) { MsgRecord msgRecord; if (mMsgRecordPool.Count &gt; 0) { msgRecord = mMsgRecordPool.Pop(); } else { msgRecord = new MsgRecord { }; } msgRecord.Name = msgName; msgRecord.OnMsgReceived = onMsgReceived; return msgRecord; } //ç§»é™¤å¯¹è±¡ public void Recycle() { Name = null; OnMsgReceived = null; mMsgRecordPool.Push(this); } public string Name; public Action&lt;object&gt; OnMsgReceived;} æ¡†æ¶çš„å®šä¹‰æ¡†æ¶ï¼šæä¾›â¼€ä¸ªæ¶æ„ï¼ˆâ½‚ä»¶ç»“æ„ã€çº¦å®šç­‰ç­‰ï¼‰ï¼Œä½ å¿…é¡»éµå®ˆå®ƒï¼Œåªè¦ä½ éµå®ˆï¼Œé‚£å‰©ä¸‹çš„å°± å…¨éƒ¨å¤„ç†é€šâ½¤éœ€æ±‚äº†ã€‚ å¥½æ¶æ„=å¥½è§„åˆ™ åº“çš„å®šä¹‰åº“ï¼Œæ’åˆ°æ—¢æœ‰ æ¶æ„ä¸Šï¼Œè¡¥å……ç‰¹å®šåŠŸèƒ½ã€‚ Unityå¸¸ç”¨æ¶æ„1.EmptyGo åœ¨ Hierarchy ä¸Šåˆ›å»ºâ¼€ä¸ªç©ºçš„ GameObject,ç„¶åæŒ‚ä¸Šæ‰€æœ‰ä¸ GameObject â½†å…³çš„é€»è¾‘æ§åˆ¶çš„è„š æœ¬ã€‚ä½¿â½¤GameObject.Find() è®¿é—®å¯¹è±¡æ•°æ®ã€‚ ç¼ºç‚¹:é€»è¾‘ä»£ç æ•£è½åœ¨å„å¤„,ä¸é€‚åˆâ¼¤å‹é¡¹â½¬ã€‚ 2.Simple GameManageræ‰€æœ‰ä¸ GameObject â½†å…³çš„é€»è¾‘éƒ½æ”¾åœ¨â¼€ä¸ªå•ä¾‹ä¸­ã€‚ ç¼ºç‚¹:å•â¼€â½‚ä»¶è¿‡äºåºâ¼¤ 3.Manager Of Managerså°†ä¸åŒçš„åŠŸèƒ½å•ç‹¬ç®¡ç†ã€‚ å¦‚ä¸‹: MainManager: ä½œä¸ºâ¼Šâ¼ç®¡ç†å™¨ã€‚ EventManager: æ¶ˆæ¯ç®¡ç†ã€‚ GUIManager: å›¾å½¢è§†å›¾ç®¡ç†ã€‚ AudioManager: â¾³æ•ˆç®¡ç†ã€‚ PoolManager: GameObjectç®¡ç†ï¼ˆå‡å°‘åŠ¨æ€å¼€è¾Ÿå†…å­˜æ¶ˆè€—,å‡å°‘GC)ã€‚ å­˜å‚¨å„ç±»å‹çš„spawnPoolï¼Œspawnpoolå­˜å‚¨å„prefabPoolã€‚åˆ é™¤å’Œæ·»åŠ æ—¶å¦‚æœä¸éœ€è¦ç«‹å³æ“ä½œï¼Œå¯ä»¥åˆ†æ­¥è¿›è¡Œæ·»åŠ åˆ é™¤ã€‚(æœ€åŸºæœ¬æ‹¥æœ‰) LevelManager: å…³å¡ç®¡ç†ã€‚ (æœ€åŸºæœ¬æ‹¥æœ‰) GameManager: æ¸¸æˆç®¡ç†ã€‚ SaveManager: é…ç½®&amp;å­˜å‚¨ç®¡ç†ã€‚(æœ€åŸºæœ¬æ‹¥æœ‰) Easy save2æ’ä»¶ä½¿ç”¨äºŒè¿›åˆ¶æ“ä½œ ï¼Œå¯¹æ•°æ®åŠ å¯† MenuManager èœå•ç®¡ç†ã€‚ 4.å°† View å’Œ Model ä¹‹é—´å¢åŠ â¼€ä¸ªåª’ä»‹å±‚UIå’Œé€»è¾‘åˆ†ç¦» MVCS: â€‹ StrangeIOC æ’ä»¶ã€‚ â€‹ IBinder.Bind&lt;Key&gt;().To&lt;Value&gt;(); â€‹ IBinder.Bind&lt;Key&gt;().To&lt;Value&gt;().ToName(name);å½“keyå’Œvalueéƒ½ç›¸åŒæ—¶ï¼Œæ ¹æ®nameåŒºåˆ† â€‹ é€šè¿‡eventå’Œlisteneræ¥è§¦å‘æŒ‰é”®çš„æ“ä½œ â€‹ æœºåˆ¶ä¾èµ–äºC#çš„Reflection(åå°„)ï¼Œæ•ˆç‡æ…¢ï¼Œæ¨¡å¼ã€æ€æƒ³å’Œç†å¿µå¯å€Ÿé‰´ MVVM: â€‹ uFrame æ’ä»¶ 5.ECS (Entity Component Based System) Unity æ˜¯åŸºäº ECS,â½è¾ƒé€‚åˆ GamePlay æ¨¡å—ä½¿â½¤ Manager Of Managersæ¶æ„æ¨¡å¼LevelManagerUnityé‡Œçš„LoadSceneæ–¹æ³•åªèƒ½ä¼ é€’sceneåå­—æˆ–indexã€‚æ”¹åæˆ–è€…å˜æ¢é¡ºåºæ—¶å˜å¾—éå¸¸éº»çƒ¦ã€‚é€šè¿‡é…ç½®è¡¨é…ç½®ï¼Œè¯»å–levelæ—¶æŒ‰é¡ºåºè¯»å–é…ç½®è¡¨å³å¯ã€‚ PoolManagerä¸¤ä¸ªç»å…¸æ“ä½œï¼ŒSpawnã€Despawn Spawnåœ¨åˆ›å»ºæ–°èµ„æºæ—¶ï¼Œå¯¹è±¡æ± æœ‰åˆ™ç›´æ¥è°ƒç”¨ï¼Œæ²¡æœ‰åˆ™éœ€è¦åˆå§‹åŒ–ã€‚ DeSpawnå½“æ± å­å®¹é‡è¾¾åˆ°æŒ‡å®šä¸Šé™æ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªæŒ‰ç…§é˜Ÿåˆ—é¡ºåºè¿›è¡Œé”€æ¯ï¼Œå…ˆè¿›å…ˆå‡ºã€‚ å¯¹è±¡æ± ä¼˜åŒ–ä¸€ä¸ªPoolManagerä¸‹æœ‰è‹¥å¹²ä¸ªSpawnPoolæ¥ç®¡ç†ä¸€ç±»çš„ç‰©ä½“ã€‚æ¯”å¦‚NPCä¸€ä¸ªPoolï¼Œç‰©å“ä¸€ä¸ªPoolã€‚ä¸€ä¸ªSpawnPoolæœ‰è‹¥å¹²ä¸ªPrefabPoolï¼Œä¸€ä¸ªPrefabPoolåªèƒ½å­˜å‚¨ä¸€ä¸ªPrefabï¼Œå¯ä»¥è¿›è¡Œå•ä¸ªPrefabçš„åŠ è½½å’Œå¸è½½ã€‚ å¯¹äºæ¯ä¸€ä¸ªPrefabPoolå¯ä»¥ç®¡ç†ä¸¤ä¸ªListï¼Œä¸€ä¸ªæ˜¯ActivetedListï¼Œä¸€ä¸ªæ˜¯DeactivateListï¼Œå¹¶ç®¡ç†æ‰€æœ‰Prefabçš„åŠ è½½å’Œå¸è½½è¿‡ç¨‹ã€‚ åœ¨åˆ é™¤æ—¶å¯¹æ•°é‡è¦ä¸¥æ ¼æ§åˆ¶ï¼Œä¸€å¸§å†…ä¸èƒ½åŒæ—¶åˆ é™¤å¤ªå¤šç‰©ä½“ï¼Œå¦åˆ™ä¼šè§¦å‘GCã€‚éœ€è¦PoolManagerç®¡ç†æ—¶èƒ½å¤Ÿç¼“é‡Šï¼Œä¸€å¸§åªåˆ é™¤å°‘é‡å¯¹è±¡ã€‚ SaveManagerEasy Save2äºŒè¿›åˆ¶è¿›è¡ŒLoadå’ŒSaveï¼Œä¸Unityå¾ˆå¥½çš„ç»“åˆï¼ŒUnityç±»å‹åŸºæœ¬éƒ½èƒ½Serializedã€‚æ¯”Jsonçš„ä¸€äº›æ–¹æ¡ˆå¿«ã€‚ MainManagerå…¥å£ç®¡ç†å™¨ï¼Œå¦‚èµ„æºåŠ è½½æµç¨‹ã€ç¬¬ä¸‰æ–¹SDKå¯åŠ¨æµç¨‹ã€çƒ­æ›´æ–°æ£€æµ‹ï¼Œéƒ½æ˜¯åœ¨å…¥å£å¤„å®Œæˆçš„ã€‚ åœ¨å¼€å‘é˜¶æ®µä¸åŒæµç¨‹ä¼šæœ‰ä¸åŒçš„logæˆ–è°ƒè¯•éœ€è¦è¿›è¡Œé˜¶æ®µåˆ’åˆ†è¿›è¡Œå±è”½ã€‚ èŒè´£ï¼š ç®¡ç†å¤šä¸ªå…¥å£ è´Ÿè´£æ¸¸æˆçš„å¯åŠ¨æµç¨‹ã€‚ é˜¶æ®µåˆ’åˆ† å¼€å‘é˜¶æ®µ:ä¸æ–­ç¼–ç -&gt;éªŒè¯ç»“æœ-&gt;ç¼–ç -&gt;éªŒè¯ç»“æœ-&gt;â€¦. å‡ºåŒ…/çœŸæœºé˜¶æ®µï¼šè·‘å®Œæ•´æµç¨‹ï¼ŒQAæµ‹è¯• å‘å¸ƒé˜¶æ®µï¼šä¸Šçº¿ å¯¹åº”çš„æšä¸¾ 12345public enum EnvironmentMode{ Developing, QA, Release} æ ¹æ®æšä¸¾æ‰§è¡ŒæŠ½è±¡æ–¹æ³• 123456789101112131415161718192021222324252627282930313233public abstract class MainManager : MonoBehaviour{ public EnvironmentMode mode; private static EnvironmentMode mSharedMode; private static bool mModeSetted = false; private void Start() { //ä¸åŒåœºæ™¯ä¸åŒmodeæ—¶åªä¼šæœ‰ä¸€ä¸ªå”¯ä¸€mode if (!mModeSetted) { mSharedMode = mode; mModeSetted = true; } switch (mSharedMode) { case EnvironmentMode.Developing: LaunchInDevelopingMode(); break; case EnvironmentMode.Test: LaunchInTestMode(); break; case EnvironmentMode.Production: LaunchInProductionMode(); break; } } protected abstract void LaunchInDevelopingMode(); protected abstract void LaunchInTestMode(); protected abstract void LaunchInProductionMode();} GuiManageråŠ è½½å¸è½½é€šè¿‡å­—å…¸ç®¡ç†ï¼ŒåŠ è½½å’Œå¸è½½é€šè¿‡å­˜å‚¨Panelåå­—ä¸ºkeyï¼ŒGameObjectä¸ºValue 123456789101112131415161718192021222324252627282930private static Dictionary&lt;string, GameObject&gt; mPanelDict = new Dictionary&lt;string, GameObject&gt;(); public static void UnLoadPanel(string PanelName) { if (mPanelDict.ContainsKey(PanelName)) { var gObj = mPanelDict[PanelName]; Destroy(gObj); } } public static GameObject LoadPanel(string PanelName, UILayer uILayer) { var PanelPrefab = Resources.Load&lt;GameObject&gt;(PanelName); var PanelObj = Instantiate(PanelPrefab, UIRoot.transform); PanelObj.name = PanelName; mPanelDict.Add(PanelName, PanelObj); switch (uILayer) { case UILayer.Bg: PanelObj.transform.SetParent(UIRoot.transform.Find(\"Bg\")); break; case UILayer.Common: PanelObj.transform.SetParent(UIRoot.transform.Find(\"Common\")); break; case UILayer.Top: PanelObj.transform.SetParent(UIRoot.transform.Find(\"Top\")); break; } return PanelObj; } å±‚çº§ç®¡ç†é€šè¿‡æšä¸¾åˆ†çº§,åœ¨Sceneä¸­åˆ›å»ºç›¸å¯¹åº”çš„GameObjectæ¥ç®¡ç†å¯¹åº”Panelçš„å±‚çº§å…³ç³» 123456public enum UILayer{ Bg, Common, Top} åœ¨åŠ è½½æ—¶åŠ è½½åˆ°å¯¹åº”å±‚çº§çš„GameObjectä¸­ 12345678910111213141516171819public static GameObject LoadPanel(string panelName, UILayer uILayer){ var canvasObj = GameObject.Find(\"Canvas\"); var PanelPrefab = Resources.Load&lt;GameObject&gt;(panelName); var PanelObj = Instantiate(PanelPrefab, canvasObj.transform); switch (uILayer) { case UILayer.Bg: PanelObj.transform.SetParent(canvasObj.transform.Find(\"Bg\")); break; case UILayer.Common: PanelObj.transform.SetParent(canvasObj.transform.Find(\"Common\")); break; case UILayer.Top: PanelObj.transform.SetParent(canvasObj.transform.Find(\"Top\")); break; } return PanelObj;} UIRootå°†å‰é¢æ‰€æè¿°çš„canvasç»“æ„ï¼Œåˆ¶ä½œä¸ºPrefabï¼Œåå­—ä¸ºUIRootï¼Œç®¡ç†æ‰€æœ‰çš„UIPanelã€‚ åœ¨GUIManagerä¸­å­˜å‚¨ä¸€ä»½ï¼Œåœ¨åŠ è½½Panelæ—¶ä½¿ç”¨ã€‚ 1234567891011121314private static GameObject mPrivateUIRoot;public static GameObject UIRoot{ get { //æ‡’åŠ è½½ if (mPrivateUIRoot == null) { mPrivateUIRoot = GameObject.Instantiate(Resources.Load&lt;GameObject&gt;(\"UIRoot\")); } mPrivateUIRoot.name = \"UIRoot\"; return mPrivateUIRoot; }} AudioManageræ’­æ”¾éŸ³æ•ˆ1234567891011/// &lt;summary&gt;éŸ³æ•ˆ &lt;/summary&gt;public void PlaySound(string soundName){ CheckAudioListener(); var doorClip = Resources.Load&lt;AudioClip&gt;(soundName); var audioSource = gameObject.AddComponent&lt;AudioSource&gt;(); audioSource.clip = doorClip; audioSource.Play();} æ’­æ”¾èƒŒæ™¯éŸ³ 12345678910111213141516/// &lt;summary&gt;èƒŒæ™¯éŸ³ &lt;/summary&gt;public void PlayMusic(string soundName, bool IsLoop = true){ CheckAudioListener(); if (mMusicSource == null) { mMusicSource = gameObject.AddComponent&lt;AudioSource&gt;(); } var doorClip = Resources.Load&lt;AudioClip&gt;(soundName); var audioSource = gameObject.AddComponent&lt;AudioSource&gt;(); audioSource.loop = IsLoop; audioSource.clip = doorClip; audioSource.Play();} PoolManagerå¯¹è±¡æ± è§£å†³çš„é—®é¢˜ å‡å°‘newæ—¶å€™å¯»å€é€ æˆçš„æ¶ˆè€—ï¼Œè¯¥æ¶ˆè€—çš„åŸå› æ˜¯å†…å­˜ç¢ç‰‡ã€‚ å‡å°‘Object.Instantiateæ—¶å†…éƒ¨è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–è€Œé€ æˆçš„CPUæ¶ˆè€—ã€‚ ç®€æ˜“å¯¹è±¡æ± è·å–çš„æ“ä½œä¸€èˆ¬ä¸ºAllocate(åˆ†é…)ï¼Œæ”¾å…¥ä¸ºRecycle(å›æ”¶)ã€‚ä¹Ÿæœ‰å«Spawnå’ŒDespawn å®šä¹‰æ± æ¥å£12345public interface IPool&lt;T&gt;{ T Allocate(); bool Recycle(T obj);} åœ¨Allocateå’ŒRecycleæ—¶ä¸åœ¨æ„å¯¹è±¡é¡ºåºï¼Œåªéœ€è¦ä½ç½®è¿ç»­ï¼Œä½¿ç”¨stackå®¹å™¨æ¥å­˜å‚¨å¯¹è±¡ã€‚ ä½¿ç”¨ä¸€ä¸ªç®€å•å·¥å‚æ¥å£æ¥åˆ›å»ºå¯¹è±¡ã€‚1234public interface IObjectFactory&lt;T&gt;{ T Create();} å¯¹è±¡æ± 12345678910111213141516171819202122232425262728public abstract class Pool&lt;T&gt; : IPool&lt;T&gt;{ protected Stack&lt;T&gt; mCachedStack = new Stack&lt;T&gt;(); protected IObjectFactory&lt;T&gt; mFactory; protected int MaxNum = 5; public int curCount { get { return mCachedStack.Count; } } public virtual T Allocate() { if (mCachedStack.Count == 0) { return mFactory.Create(); } return mCachedStack.Pop(); } public abstract bool Recycle(T obj); //public virtual bool Recycle(T obj) //{ // if (mCachedStack.Count &gt;= MaxNum) // { // return false; // } // mCachedStack.Push(obj); // return true; //}} åŸºäºå·¥å‚æ¥å£çš„ç®€æ˜“å·¥å‚12345678910111213141516171819/// &lt;summary&gt;/// åŸºäºå·¥å‚æ¥å£çš„ç®€æ˜“å·¥å‚/// &lt;/summary&gt;/// &lt;typeparam name=\"T\"&gt;&lt;/typeparam&gt;public class CustomObjectFactroy&lt;T&gt; : IObjectFactory&lt;T&gt;{ /// &lt;summary&gt; /// ä½¿ç”¨å§”æ‰˜è®¾ç½®ç±»å†…éƒ¨ä¿¡æ¯ /// &lt;/summary&gt; private Func&lt;T&gt; mFactoryMethod; public CustomObjectFactroy(Func&lt;T&gt; factoryMethod) { mFactoryMethod = factoryMethod; } public T Create() { return mFactoryMethod(); }} åŒ…å«åˆ›å»ºæ–¹æ³•çš„ç®€æ˜“å¯¹è±¡æ± 123456789101112131415161718192021222324252627/// &lt;summary&gt;/// ç®€æ˜“å¯¹è±¡æ± /// &lt;/summary&gt;/// &lt;typeparam name=\"T\"&gt;&lt;/typeparam&gt;public class SimpleObjectPool&lt;T&gt; : Pool&lt;T&gt;{ //é‡ç½®æ–¹æ³• Action&lt;T&gt; mResetMethod; public SimpleObjectPool(Func&lt;T&gt; factoryMethod, Action&lt;T&gt; ResetMethod = null, int initCount = 0) { mFactory = new CustomObjectFactroy&lt;T&gt;(factoryMethod); mResetMethod = ResetMethod; for (int i = 0; i &lt; initCount; i++) { mCachedStack.Push(mFactory.Create()); } } public override bool Recycle(T obj) { if (mResetMethod != null) { mResetMethod(obj); } mCachedStack.Push(obj); return true; }} å¤ç›˜è®¾è®¡ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ¨¡å—ç»“æ„æ—¶,å¯ä»¥å…ˆè®¾è®¡ä¸€ä¸ªæ¥å£(è§„èŒƒ)ã€‚æè¿°å†…å®¹æœ‰ä»€ä¹ˆ åœ¨mFractroy.Createå’ŒRecycle(å›æ”¶)æ—¶ï¼Œæ›´åå‘äºè‡ªå®šä¹‰çš„æ“ä½œ LevelManager123456789101112131415161718192021222324public class LevelManager : MonoBehaviour{ //å¯æ¢æˆé…ç½®è¡¨ private static List&lt;string&gt; mLevelNames; public static int Index { get; set; } public static void Init(List&lt;string&gt; levelNames) { mLevelNames = levelNames; Index = 0; } public static void LoadCurrent() { SceneManager.LoadScene(mLevelNames[Index]); } public static void LoadNext() { Index++; if (Index &gt;= mLevelNames.Count) { Index = 0; } SceneManager.LoadScene(mLevelNames[Index]); }} å•å…ƒæµ‹è¯•Probjectå†…-&gt;å³é”®-&gt;Create-&gt;Testing åˆ›å»ºç›¸å¯¹åº”çš„c#æ–‡ä»¶(testæ¨¡æ¿)åœ¨Test Runner ç•Œé¢å†…å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æµ‹è¯•è„šæœ¬å’Œå¯¹åº”çš„æ–¹æ³• ç±»ä¼¼äºè‡ªå·±ç¼–å†™æµ‹è¯•ç”¨ä¾‹è¿›è¡Œæµ‹è¯• Assert.AreEqualå«åšæ–­è¨€ï¼Œåœ¨å¼€å‘å¤§é¡¹ç›®æ—¶éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚æµ‹è¯•é€šä¸é€šè¿‡å–å†³äºæ–­è¨€é€šä¸é€šè¿‡ã€‚","categories":[{"name":"æ¡†æ¶ç¯‡","slug":"æ¡†æ¶ç¯‡","permalink":"http://ysich.github.io/categories/%E6%A1%86%E6%9E%B6%E7%AF%87/"}],"tags":[{"name":"Manager æ¡†æ¶","slug":"Manager-æ¡†æ¶","permalink":"http://ysich.github.io/tags/Manager-%E6%A1%86%E6%9E%B6/"}]},{"title":"æ¸¸æˆèµ„æºç®¡ç†","slug":"æ¸¸æˆèµ„æºç®¡ç†","date":"2023-01-16T04:56:44.000Z","updated":"2023-02-01T07:29:27.892Z","comments":true,"path":"2023/01/16/æ¸¸æˆèµ„æºç®¡ç†/","link":"","permalink":"http://ysich.github.io/2023/01/16/%E6%B8%B8%E6%88%8F%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/","excerpt":"","text":"æ¸¸æˆèµ„æºç®¡ç†æ¸¸æˆè¿è¡Œå°±æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªèµ„æºçš„å±•ç¤ºï¼Œå¦‚ä½•ç®¡ç†å¥½è¿™äº›å±•ç¤ºçš„èµ„æºè®©æ¸¸æˆèƒ½å¤Ÿæµç•…è¿è¡Œåœ¨å¼€å‘ä¸­éå¸¸é‡è¦ã€‚éœ€è¦åœ¨åˆç†çš„åœ°æ–¹è°ƒç”¨ã€åŠ è½½èµ„æºï¼Œèµ„æºç©ºé—²æ—¶å¯¹å…¶è¿›è¡Œå¸è½½ä»¥å‡å°‘å†…å­˜å ç”¨ã€‚å½“å†…å­˜è¶…å‡ºé¢„ç®—å¯èƒ½å¯¼è‡´æ¸¸æˆé—ªé€€ï¼Œæ‰€ä»¥å¯¹èµ„æºçš„ç®¡ç†å®é™…å°±æ˜¯å¯¹å†…å­˜çš„ä¼˜åŒ–ï¼ æœ¬æ–‡äº‰å–ä¸€æ–‡ææ‡‚èµ„æºç®¡ç†ã€‚PSï¼šå¯èƒ½å’Œä¸€ä¸ªè§†é¢‘å­¦å®Œc++å·®ä¸å¤š(ä¸€ä¸ªè§†é¢‘ä¸€ä¸ªå¤šæœˆ) TODOLISTï¼š åˆ†åŒ…ç­–ç•¥ ä¾èµ–å¤„ç† AssetBundleè¯¦ç»† çƒ­æ›´ æ–­ç‚¹ç»­ä¼  ä»£ç çƒ­æ›´æ–°/çƒ­é‡è½½ Luaé‡æ–°å°†å‡½æ•°æŒ‡é’ˆèµ‹å€¼çš„ç­–ç•¥ HybridCLR èµ„æºåŒ…å’Œèµ„æºåŒºåˆ†å¼€ ä¸€äº›èµ„æºç­–ç•¥ æ•´åŒ…åªæœ‰åŸºç¡€å†…å®¹ï¼Œåç»­ç« èŠ‚çƒ­æ›´çš„å½¢å¼(å¤§èµ„æºæƒ…å†µ) YooAssetæ‰©å±•ç¯‡ èµ„æºç®¡ç†ä¸»è¦çš„éœ€æ±‚æœ‰å“ªäº›ï¼Ÿ ä¸ºå¼€å‘ä¸æ­£å¼ç‰ˆæœ¬æä¾›èµ„æºçš„åŠ è½½å’Œå¸è½½ æ”¯æŒè¿œç¨‹æ›´æ–°èµ„æº åšå¥½ç‰ˆæœ¬ã€å¹³å°ã€æ¸ é“çš„èµ„æºç®¡ç† å†…å­˜ä¼˜åŒ– Unityä¸­çš„ä¸¤ç§åŠ è½½æ–¹å¼Resources èµ„æºå¿…é€‰æ”¾åœ¨Resourcesæ–‡ä»¶å¤¹ä¸‹ï¼›æœ‰å®¹é‡ä¸Šé™(å¤§æ¦‚æ˜¯2G)ï¼›é‡å¤åŠ è½½å’Œé‡å¤å¸è½½æ“ä½œï¼ŒUnityåšäº†å®¹é”™å¤„ç†ä¸ä¼šæŠ¥é”™ã€‚ä¸æ”¯æŒçƒ­æ›´ï¼Œåªèƒ½æ‰“æ•´åŒ… é€‚åˆæ”¾æ¸¸æˆçš„å¯åŠ¨é€»è¾‘éœ€è¦çš„èµ„æº å¯èƒ½ä¼šå»¶é•¿æ¸¸æˆå¯åŠ¨æ—¶é—´ AssetBundle å¯ä»¥ç†è§£æˆUnityå†…çš„èµ„æºå‹ç¼©åŒ…ï¼Œæœ‰ä¸åŒçš„å‹ç¼©æ–¹å¼ï¼Œè§£å‹é€Ÿåº¦å’ŒåŒ…ä½“å¤§å°ä¹Ÿä¸åŒ(LZMA å’Œ LZ4)ã€‚ é€‚åˆåšçƒ­æ›´ï¼Œä»¥å‡å°‘åŒ…ä½“çš„åˆå§‹å¤§å°ã€‚ å·²åŠ è½½çš„èµ„æºä¸å…è®¸é‡å¤åŠ è½½ï¼Œä¼šæŠ¥é”™ã€‚è€Œä½¿ç”¨AssetDatabaseåˆ™ä¸éœ€è¦è€ƒè™‘ã€‚éœ€è¦ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€äº›å¼€æºçš„èµ„æºç®¡ç†ç³»ç»Ÿï¼Œå¦‚YooAssetã€‚ åŒæ­¥åŠ è½½ä¸å¼‚æ­¥åŠ è½½åŒæ­¥åŠ è½½åŒæ­¥åŠ è½½åœ¨åŠ è½½èµ„æºæ—¶ï¼Œä¼šé˜»å¡çº¿ç¨‹ã€‚ç­‰åŠ è½½é€»è¾‘å®Œæˆåæ‰ç»§ç»­æ‰§è¡Œåç»­é€»è¾‘ï¼ˆå›¾çµæœºï¼‰ å¼‚æ­¥åŠ è½½åŒæ­¥åŠ è½½åœ¨åŠ è½½è¾ƒå¤§èµ„æºæ—¶é˜»å¡æ˜æ˜¾ï¼Œé€ æˆå¡é¡¿ã€‚å› ä¸ºUnityä¸­æ‰€æœ‰çš„æ¸²æŸ“éƒ½æ˜¯æ”¾åœ¨ä¸»çº¿ç¨‹ä¸­çš„ï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹é˜»å¡éå¸¸è‡´å‘½ä¸èƒ½è¿›è¡Œä»»ä½•ç©å®¶æ“ä½œã€‚ æ‰€ä»¥éœ€è¦ä½¿ç”¨å¦å¤–ä¸€ç§åŠ è½½æ–¹å¼å¯¹è¾ƒå¤§èµ„æºè¿›è¡ŒåŠ è½½ã€‚å¼‚æ­¥åŠ è½½ä½¿ç”¨åç¨‹/çº¿ç¨‹è¿›è¡ŒåŠ è½½é€»è¾‘ï¼Œç­‰èµ„æºåŠ è½½å®Œæ¯•åè§¦å‘èµ„æºåŠ è½½åçš„callbackã€‚ åœ¨ä¸€äº›èµ„æºçš„åŠ è½½ä¼šå½±å“åˆ°æ¸¸æˆçš„å±•ç¤ºæ—¶ï¼Œå¯ä»¥åœ¨éœ€è¦ä¹‹å‰å¯¹èµ„æºè¿›è¡Œé¢„å…ˆåŠ è½½ï¼Œä¿è¯æµç¨‹èƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œã€‚ å¼‚æ­¥åŠ è½½çš„ä¸‰ç§çŠ¶æ€å¼‚æ­¥åŠ è½½çš„é€»è¾‘ç”±äºæ‰§è¡Œå®Œæˆçš„æ—¶é—´ä¸ç¡®å®šï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–é€»è¾‘çš„å†²çªã€‚æ‰€ä»¥æˆ‘ä»¬ç»™å¼‚æ­¥åŠ è½½æŒ‰ç…§é€»è¾‘åˆ’åˆ†çŠ¶æ€ï¼Œå¥½è®©å…¶ä»–é€»è¾‘èƒ½å¤ŸåšåŒºåˆ†ï¼Œä¸åŒçŠ¶æ€ä¸‹å¤„ç†ç›¸åº”çš„æ“ä½œã€‚ æœªåŠ è½½ å¼‚æ­¥åŠ è½½è¿˜æ²¡å¼€å§‹æ—¶å¯èƒ½éœ€è¦å‡†å¤‡çš„äº‹æƒ…ï¼Œæ¯”å¦‚èµ„æºåŒ…ä¸åœ¨æœ¬åœ°éœ€è¦ä¸‹è½½ã€è§£å¯†ã€è§£å‹ç­‰ç­‰ã€‚ åŠ è½½ä¸­ èµ„æºå¼€å§‹åŠ è½½åï¼Œå…¶ä»–ä¸šåŠ¡é€»è¾‘ä¹ŸåŠ è½½äº†ç›¸åŒèµ„æºæ—¶ï¼Œå¯ä»¥åˆ¤æ–­è¿™ä¸ªèµ„æºçš„çŠ¶æ€ã€‚æ­£åœ¨åŠ è½½åˆ™ä¸å†è¿›è¡ŒåŠ è½½å‰çš„å‡†å¤‡æ“ä½œï¼Œå¹¶æŠŠåŠ è½½åçš„callbackæ³¨å†Œè¿›å»ã€‚ å·²åŠ è½½ ä¸»è¦ä¸ºåŠ è½½åè§¦å‘ç›¸åº”callbackã€‚ 123456public enum LoaderState { NONE, // é»˜è®¤ LOADING, // åŠ è½½ä¸­ FINISHED, // å®Œæˆ } å­˜åœ¨é—®é¢˜ç©å®¶åœ¨è¿›å…¥ä¸€ä¸ªåœºæ™¯åï¼Œå‡è®¾èµ„æºé¢„åŠ è½½éœ€è¦10sï¼Œç©å®¶å´åœ¨æœªåŠ è½½å®Œèµ„æºçš„è¿‡ç¨‹ä¸­é€€å‡ºåœºæ™¯ã€‚è¿™æ—¶å€™å°±ä¼šå¼•å‘èµ„æºçŠ¶æ€çš„é—®é¢˜ã€‚ èµ„æºç¼“å­˜æ± èµ„æºç¼“å­˜æ± ä¸ºç»Ÿä¸€å­˜å‚¨å’Œè°ƒç”¨èµ„æºçš„åœ°æ–¹ã€‚åœ¨åŠ è½½èµ„æºåç»Ÿä¸€å­˜å…¥æ± å­ä¸­ï¼Œå¸è½½æ—¶åˆ™å°†å…¶ä»æ± å­ä¸­åˆ é™¤ã€‚ åŠ è½½æ—¶å…ˆåˆ¤æ–­æ± å­ä¸­æ˜¯å¦å­˜åœ¨æ­¤èµ„æºåŒ…ï¼Œå¦‚æœå·²ç»åŠ è½½è¿‡äº†ç›´æ¥åˆ™ç›´æ¥ä½¿ç”¨ï¼ŒæœªåŠ è½½å†è¿›è¡ŒåŠ è½½é€»è¾‘ã€‚ ä»¥ä¸‹å†…å®¹ä¸»è¦ä»¥AssetBundleä¸¾ä¾‹ 123public class AssetBundlePool{ private Dictionary&lt;string,AssetBundleInfo&gt; m_LoadAssetBundle = new Dictionary&lt;string,AssetBundleInfo&gt;();} å¼•ç”¨è®¡æ•°åŸºç¡€æ¦‚å¿µå¼•ç”¨æŠ€æœ¯çš„åº”ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œå¾ˆå¤šå¼•æ“ã€æ¡†æ¶ã€æ’ä»¶çš„åº•å±‚éƒ½ç¦»ä¸å¼€å¼•ç”¨è®¡æ•°ã€‚ ç®€å•æ€æƒ³ï¼šè¢«å¼•ç”¨+1ï¼Œä¸è¢«å¼•ç”¨æ—¶-1ï¼Œå½“ä¸º0æ—¶è§¦å‘æ¸…ç©ºé€»è¾‘ã€‚ 123456789101112131415161718192021public interface IRefCounter{ int RefCount { get; } void Retain(); void Release();}public class SimpleRC : IRefCounter{ public int RefCount { get; private set; } public void Retain() { RefCount++; } public void Release() { RefCount--; if (RefCount == 0){ OnZeroRef(); } } protected virtual void OnZeroRef(){}} ä¸èµ„æºç®¡ç†ç»“åˆçš„å¼•ç”¨è®¡æ•°èµ„æºè¢«ä½¿ç”¨æ—¶å¼•ç”¨æ¬¡æ•°+1ï¼Œèµ„æºè§£é™¤ä½¿ç”¨æ—¶æ¬¡æ•°-1ï¼Œå½“å¼•ç”¨æ¬¡æ•°ä¸º0æ—¶åˆ™è¿›è¡Œå¸è½½é€»è¾‘ã€‚ 1234567891011public class AssetBundleInfo{ private AssetBundle m_AssetBundle; //ABåŒ…å¼•ç”¨ public AssetBundle AssetBundle { get { return m_AssetBundle; } } public int m_ReferencedCount; //å¼•ç”¨è®¡æ•° public AssetBundleInfo(AssetBundle assetBundle) { m_AssetBundle = assetBundle; m_ReferencedCount = 1; }} ä¸èµ„æºç¼“å†²æ± ç»“åˆçš„åŠ è½½123456789101112131415161718192021222324252627public class AssetBundlePool{ private Dictionary&lt;string,AssetBundleInfo&gt; m_LoadAssetBundle = new Dictionary&lt;string,AssetBundleInfo&gt;(); public AssetBundle LoadAssetsFromAB(string abName) { AssetBundleInfo assetBundleInfo = null; if (m_LoadAssetBundle.TryGetValue(abName, out assetBundleInfo)) { //æ£€æŸ¥æ˜¯å¦åŠ è½½è¿‡ assetBundleInfo.m_ReferencedCount++;//è¿™é‡Œå¯ä»¥ä½¿ç”¨å°è£…å¥½çš„å¼•ç”¨è®¡æ•°ï¼Œä¸ºäº†æ–¹ä¾¿å±•ç¤ºç›´æ¥ä½¿ç”¨ } else { string loadPath = PathUnit.DataPath + PathUnit.ABRootPath + abName; var ab = AssetBundle.LoadFromFile(loadPath); if (ab is null) { Debug.Log(\"ABåŒ…åŠ è½½å¤±è´¥ï¼\"+ loadPath); } else { assetBundleInfo = new AssetBundleInfo(ab); m_LoadAssetBundle.Add(abName, assetBundleInfo); //assetBundleInfo.m_ReferencedCount++;è¿™é‡Œä¸éœ€è¦åŠ äº†å› ä¸ºé»˜è®¤å€¼ä¸º1 } } return assetBundleInfo.AssetBundle; }} å¼‚æ­¥åŠ è½½ä¹Ÿæ˜¯ç›¸åŒçš„æ“ä½œï¼Œä½†æœ‰ç‚¹ä¸åŒã€‚éœ€è¦ä¸€ä¸ªé¢å¤–çš„é˜Ÿåˆ—è®°å½•åŠ è½½ä¸­çš„æ–‡ä»¶ã€‚å½“åŠ è½½ä¸­çš„æ–‡ä»¶åˆæ”¶åˆ°äº†åŠ è½½è¯·æ±‚æ—¶ï¼Œåˆ™éœ€è¦åœ¨åˆ—è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æ­£åœ¨åŠ è½½ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class AssetBundleCachePool{ public MonoBehaviour monoBehaviour; private Dictionary&lt;string, AssetBundleInfo&gt; m_LoadAssetBundle = new Dictionary&lt;string, AssetBundleInfo&gt;(); private Dictionary&lt;string, Action&lt;AssetBundle&gt;&gt; m_LoadingAssetBundle = new Dictionary&lt;string, Action&lt;AssetBundle&gt;&gt;(); public void LoadAssetsFormAbAsync(string abName, Action&lt;AssetBundle&gt; loadingABAction) { monoBehaviour.StartCoroutine(OnLoadAssetsFormAbAsync(abName, loadingABAction)); } IEnumerator OnLoadAssetsFormAbAsync(string abName, Action&lt;AssetBundle&gt; loadingABAction) { AssetBundleInfo assetBundleInfo = null; if (m_LoadAssetBundle.TryGetValue(abName,out assetBundleInfo)) { Debug.Log(\"å·²åŠ è½½è¿‡\"); AssetBundle assetBundle = assetBundleInfo.AssetBundle; //å¼•ç”¨è®¡æ•°+1 assetBundleInfo.m_ReferencedCount++; //è§¦å‘å›è°ƒ if (loadingABAction != null) { loadingABAction.Invoke(assetBundle); } yield break; } else { if (m_LoadingAssetBundle.TryGetValue(abName,out Action&lt;AssetBundle&gt; temploadingABAction)) { if (loadingABAction != null) { temploadingABAction += loadingABAction; } Debug.Log(\"æ­£åœ¨è¢«åŠ è½½\"); yield break; } else { //è¿™æ­¥éœ€è¦æ‰§è¡Œï¼Œé¿å…ä¸å…¶ä»–é€»è¾‘å†²çª m_LoadingAssetBundle.Add(abName, loadingABAction); string loadPath = PathUnit.DataPath + PathUnit.ABRootPath + abName; AssetBundleCreateRequest assetBundleCreateRequest = AssetBundle.LoadFromFileAsync(loadPath); AssetBundle resAB = assetBundleCreateRequest.assetBundle; if (resAB is null) { Debug.LogError(\"ABåŒ…ä¸èƒ½å­˜åœ¨\"); } else { assetBundleInfo = new AssetBundleInfo(resAB); m_LoadAssetBundle.Add(abName, assetBundleInfo); } //åŠ è½½å®Œæˆç§»é™¤åŠ è½½ä¸­åˆ—è¡¨ //é¿å…å•¥å¼‚å¸¸çŠ¶å†µï¼Œä¿é™©ç‚¹ï¼å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (m_LoadingAssetBundle.ContainsKey(abName)) { Action&lt;AssetBundle&gt; action = m_LoadingAssetBundle[abName]; m_LoadingAssetBundle.Remove(abName); var callBackList = action.GetInvocationList(); foreach (Action&lt;AssetBundle&gt; callBack in callBackList) { callBack.Invoke(resAB); } } } } }} ä¸èµ„æºç¼“å†²æ± ç»“åˆçš„å¸è½½ä¸ºäº†ä¿æŒå¹³è¡¡æœ‰äº†åŠ è½½å°±ä¸€å®šä¼šæœ‰å¸è½½ã€‚ä½†æ˜¯åœ¨æ¸¸æˆä¸­(ç‰¹åˆ«æ˜¯æ‰‹æ¸¸)å¸è½½æ“ä½œéœ€è¦åŠ ä¸Šä¸€äº›é™åˆ¶ï¼Œå› ä¸ºåœ¨çŸ­æ—¶é—´å†…è¿›è¡Œäº†å¤§é‡èµ„æºçš„å¸è½½å¢åŠ äº†å¤§é‡çš„IOæ“ä½œä¹Ÿä¼šé€ æˆå¡é¡¿ï¼ˆçº¿ç¨‹é˜»å¡ï¼‰çš„ã€‚ğŸ™‚ æ‰€ä»¥æˆ‘ä»¬çš„å¸è½½æ“ä½œéœ€è¦ä¸æ•°é‡å’Œæ—¶é—´æ‰¯ä¸Šå…³ç³»ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…åªå¸è½½ä¸€å®šæ•°é‡çš„èµ„æºã€‚ åœ¨å¼•ç”¨è®¡æ•°ä¸­ï¼Œå¦‚æœå¼•ç”¨è®¡æ•°ä¸º0åˆ™æ ‡è®°ä¸ºå¯ä»¥å¼€å§‹å¸è½½äº†ã€‚ 1234567891011121314public class AssetBundleInfo{ public int ReferencedCount { get { return m_ReferencedCount; } set { m_ReferencedCount = value; if (m_ReferencedCount&lt;= 0) IsUnLoadFlag = true; else IsUnLoadFlag = false; } } public bool IsUnLoadFlag { get; private set; } private int m_ReferencedCount; //å¼•ç”¨è®¡æ•°} ä¸æ—¶é—´æŒ‚é’©ä¸æ—¶é—´æŒ‚é’©å°±éœ€è¦æœ‰ä¸ªåœ°æ–¹èƒ½å¤Ÿä¸€ç›´ç»Ÿè®¡å’Œè®¡ç®—æˆ‘ä»¬çš„æ—¶é—´å¹¶è¿›è¡Œå›æ”¶ 123456public class ResourceManager{ void Update(){ }} ä¾èµ–æœ¬æ–‡ä¹‹å‰çš„ä»£ç éƒ½æ˜¯æ²¡æœ‰è€ƒè™‘ä¾èµ–çš„ï¼Œæ‰€ä»¥å¦‚æœçœŸçš„è·‘èµ·æ¥ä¼šå‘ç°è®¡æ•°ä¼šæœ‰åå·®ã€‚ ä¸€ä¸ªèµ„æºèº«ä¸Šç”¨åˆ°äº†åˆ«çš„ABåŒ…ä¸­çš„èµ„æºï¼Œè¿™æ—¶å€™å¦‚æœåªåŠ è½½è‡ªèº«çš„ABåŒ…ï¼Œå°±ä¼šå‡ºç°èµ„æºä¸¢å¤±çš„æƒ…å†µã€‚è¿™æ—¶å€™å°±éœ€è¦æŠŠå½“å‰èµ„æºéœ€è¦ç”¨åˆ°çš„ä¾èµ–åŒ…ä¸€èµ·åŠ è½½å‡ºæ¥ã€‚ ä½†æ˜¯æˆ‘ä»¬åˆè¦æ€ä¹ˆçŸ¥é“è¿™ä¸ªèµ„æºä¾èµ–äºå“ªäº›åŒ…ï¼Ÿ è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°Unityæä¾›çš„ABåŒ…ä¾èµ–æ–‡ä»¶æ¥åˆ¤æ–­ï¼Œåç¼€.manifestÂ·ã€‚ Assetç¯‡Assetä»€ä¹ˆæ˜¯Asstï¼Ÿæµ…è°ˆAssetsâ€”â€”Unityèµ„æºæ˜ å°„ - UWAé—®ç­” | åšå®¢ | æ¸¸æˆåŠVRåº”ç”¨æ€§èƒ½ä¼˜åŒ–è®°å½•åˆ†äº« | ä¾‘è™ç§‘æŠ€ (uwa4d.com) Resourcesä»€ä¹ˆæ˜¯Resourcesï¼ŸResourcesç›®å½•çš„ä¼˜ç‚¹ä¸ç—›ç‚¹ - UWAé—®ç­” | åšå®¢ | æ¸¸æˆåŠVRåº”ç”¨æ€§èƒ½ä¼˜åŒ–è®°å½•åˆ†äº« | ä¾‘è™ç§‘æŠ€ (uwa4d.com) AssetBundleä»€ä¹ˆæ˜¯AssetBundleï¼ŸAssetBundleçš„åŸç†åŠæœ€ä½³å®è·µ - UWAé—®ç­” | åšå®¢ | æ¸¸æˆåŠVRåº”ç”¨æ€§èƒ½ä¼˜åŒ–è®°å½•åˆ†äº« | ä¾‘è™ç§‘æŠ€ (uwa4d.com) çƒ­æ›´ç¯‡TodoğŸ’â™€è¿™éƒ¨åˆ†å†…å®¹å†™åœ¨åˆ«çš„åœ°æ–¹ï¼Œæ¯”è¾ƒä¹±åç»­æ•´ç†ã€‚","categories":[{"name":"èµ„æºç®¡ç†ç¯‡","slug":"èµ„æºç®¡ç†ç¯‡","permalink":"http://ysich.github.io/categories/%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%AF%87/"}],"tags":[{"name":"èµ„æºç®¡ç†","slug":"èµ„æºç®¡ç†","permalink":"http://ysich.github.io/tags/%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/"}]},{"title":"LuaåŸºç¡€è¯­æ³•","slug":"LuaåŸºç¡€è¯­æ³•","date":"2023-01-13T06:12:28.000Z","updated":"2023-01-17T06:16:15.830Z","comments":true,"path":"2023/01/13/LuaåŸºç¡€è¯­æ³•/","link":"","permalink":"http://ysich.github.io/2023/01/13/Lua%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","excerpt":"","text":"LuaåŸºç¡€è¯­æ³•æ³¨æ„ç‚¹ å¾ªç¯ç”¨doï¼Œifè¯­å¥ç”¨thenï¼Œéƒ½ä½¿ç”¨endç»“å°¾ Luaä¸æ”¯æŒè‡ªå‡å’Œè‡ªåŠ æ“ä½œï¼Œåªèƒ½i=i+1ï¼Œi=i-1 å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªä½ç½®æ˜¯1ä¸æ˜¯0 æŠ€å·§ Luaçš„å­—ç¬¦ä¸²å¯ä»¥å­˜å‚¨0x00ï¼Œå¯ä»¥ç”¨å­—ç¬¦ä¸²å­˜å‚¨äºŒè¿›åˆ¶æµ æ³¨é‡Š ç”¨--å¼€å¤´ï¼Œæ¥å†™ä¸€æ®µå•è¡Œæ³¨é‡Š 1-- å•è¡Œæ³¨é‡Š ç”¨--[[å¼€å¤´ï¼Œ]]ç»“å°¾ï¼Œå†™ä¸€æ®µå¤šè¡Œæ³¨é‡Šã€‚ 1234--[[ å¤šè¡Œ æ³¨é‡Š]] å˜é‡å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œèµ‹å€¼å°±ç›¸å½“äºå£°æ˜å˜é‡ï¼Œä¸pythonç›¸ä¼¼ å£°æ˜çš„å˜é‡é»˜è®¤ä¸ºå…¨å±€å˜é‡1a=1 åŒæ—¶ç»™å¤šä¸ªå˜é‡èµ‹å€¼ï¼Œå¤šé‡èµ‹å€¼ 1a,b=1,2 å±€éƒ¨å˜é‡1local b=2 nilç±»å‹æ²¡æœ‰è¢«å£°æ˜è¿‡çš„å˜é‡éƒ½æ˜¯nil nilç±»å‹åªæœ‰ä¸€ä¸ªå€¼ï¼Œå°±æ˜¯nil nilç±»ä¼¼nullç±»å‹ if(nil)ä¸ºfalse numberç±»å‹1234--æ”¯æŒåå…­è¿›åˆ¶è¡¨ç¤ºæ–¹æ³•a=0x11--è¾“å‡ºä¸º17--ç§‘å­¦è®¡æ•°æ³•a=2e10 stringç±»å‹å•å¼•å·ã€åŒå¼•å·1234a=\"daeqeq\"b='sdarrr'--è½¬ä¹‰å­—ç¬¦\\nd=\"sdada\\nsdar\" å¤šè¡Œæ–‡æœ¬å¤šè¡Œæ–‡æœ¬æ— æ³•ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ 1c=[[asdasfffrrqweqq]] å­—ç¬¦ä¸²è¿æ¥å­—ç¬¦ä¸²è¿æ¥ç¬¦å·.. 1234a=\"daeqeq\"b='sdarrr'c=a..bprint(\"asdaf\"..\"as232\") æ•°å€¼è½¬å­—ç¬¦ä¸²1tostring(10) å­—ç¬¦ä¸²è½¬æ•°å€¼tonumberè½¬æ¢å¤±è´¥ä¸ºnil 1tonumber(\"193\") è·å–å­—ç¬¦ä¸²é•¿åº¦123a=\"daeqeq\"print(#a)--ç­‰ä»·äºs:len() stringç±»å‹ç±»ä¼¼charæ•°ç»„Luaä¸­stringç±»å‹ ç±»ä¼¼äºCé‡Œçš„å­—ç¬¦æ•°ç»„ï¼Œå¯ä»¥åŒ…å«ä»»æ„æ•°å€¼åŒ…æ‹¬0x00ï¼Œå¯ä»¥å­˜å‚¨äºŒè¿›åˆ¶æµå› ä¸ºéƒ½æ˜¯åŸåŸæœ¬æœ¬å­˜å‚¨ å°†asciiç è½¬ä¸ºå­—ç¬¦ä¸²12s=string.char(65)s=string.char(0x30,0x31,0x32,0x33) å–å‡ºstringä¸­çš„æŸä¸€ä½çš„asciiç 1234n=string.byte(s,2)print(n)--è¯­æ³•ç³–ï¼Œç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªs:byte(1ï¼Œ-1) formatè°ƒç”¨cçš„æ¥å£ 12local f=string.format(\"%d,%d\",1,2)print(f) functionå‡½æ•°å‡½æ•°é»˜è®¤è¿”å›å€¼ä¸ºnilï¼Œæ²¡æœ‰ä»»ä½•è¿”å›å€¼åˆ™ä¸ºnil 1234567function function_name() --bodyend--å‡½æ•°åæ”¾å‰é¢f=function(...) --bodyend 123456function f(a,b,c) print(a,b,c) return aend--cæ²¡æœ‰ä¼ å€¼åˆ™ä¸ºnilprint(f(1,2))--1 å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªå€¼12345function f(a,b,c) return a,bendprint(f(1,2)) å¤šä¸ªè¿”å›å€¼å¯ä»¥ä½¿ç”¨å¤šé‡èµ‹å€¼è¯­å¥12345function f(a,b,c) return a,bendlocal i,j=f(1,2) tabletableæ¥å£123table.insert(a,\"d\")--æ’å…¥å…ƒç´ ï¼Œæœ«å°¾æ·»åŠ table.insert(a,2,\"d\")--æ’å…¥å…ƒç´ ï¼Œç¬¬äºŒä¸ªä½ç½®ï¼Œåç»­å…ƒç´ åç§»local s= table.remove(a,2)--ç§»é™¤ç¬¬2ä¸ªå…ƒç´  tableæ•°å­—ä¸‹æ ‡å¯ä»¥å­˜æ‰€æœ‰ä¸œè¥¿(number,string,table,function) 12345a={1,\"ac\",{},function() end}a[5]=123 --å¯ä»¥ç›´æ¥æ·»åŠ ä¸€ä¸ªå…ƒç´ print(a[1])--è·å–tableé•¿åº¦print(#a) tableå­—ç¬¦ä¸²ä¸‹æ ‡ä»¥å­—ç¬¦ä¸ºtableçš„ä¸‹æ ‡ 12345678910a={ a=1, b=\"1234\", c=function() end, d=123123}print(a[\"a\"])--ä¸‹æ ‡ç¬¦åˆå˜é‡å‘½åè§„èŒƒæ—¶print(a.a) å…¨å±€è¡¨_GLuaå†…çš„æ‰€æœ‰å…¨å±€å˜é‡éƒ½åœ¨_Gè¿™ä¸ªtableå†… åŒ…æ‹¬table.insertä¸­çš„table(ä¹Ÿæ˜¯å…¨å±€å˜é‡)ä¹Ÿå­˜å‚¨åœ¨_Gä¸­ï¼Œinsertä¸ºtableçš„ä¸‹æ ‡ 1234print(_G[\"table\"][\"insert\"])--function: 0000000063be4590--è¾“å‡ºå€¼ä¸ºä¸€ä¸ªå‡½æ•°--å¤šæ–‡ä»¶è°ƒç”¨çŸ¥è¯† å¸ƒå°”å‹ä¸ç­‰äºåœ¨Luaä¸­ä¸ç­‰äºä½¿ç”¨~=è¡¨ç¤º 123456789a=trueb=falseprint(1&gt;2)print(1&lt;2)print(1&gt;=2)print(1&lt;=2)print(1==2)--ä¸ç­‰äºprint(1~=2) ä¸æˆ–éåªæœ‰falseå’Œnilè¡¨ç¤ºå‡å…¶ä»–éƒ½è¡¨ç¤ºçœŸï¼ŒåŒ…æ‹¬0 123print(a and b)print(a or b)print(not a) and``orè¿”å›çš„å¹¶ä¸å®Œå…¨æ˜¯trueå’Œfalseï¼Œä¼šç›´æ¥è¿”å›aæˆ–è€…bçš„å€¼ï¼Œå¯ä»¥é€šè¿‡çŸ­è·¯æ±‚å€¼ åªæœ‰notè¿”å›trueå’Œfalse 123456a=nil --çœŸb=0 --å‡print(a and b) --nilprint(a or b) --0print(not a) --trueprint(b&gt;10 and \"yes\" or \"no\") --no åˆ†æ”¯åˆ¤æ–­ifè¯­å¥1234567if 1&gt;10 then print(\"1&gt;10\")elseif 1&lt;10 then print(\"1&lt;10\")else print(\"no\")end å¾ªç¯forå¾ªç¯1234567for i=1,10 do print(i)end--æ­¥é•¿ä¸º2for i=1,10,2 do print(i)end å€’åºå¾ªç¯123for i=10,1,-1 do print(i)end iåœ¨è¿‡ç¨‹é€”ä¸­ä¸èƒ½èµ‹å€¼ï¼Œèµ‹å€¼äº†ä¹Ÿæ²¡ç”¨ å‡å¦‚å¯¹ièµ‹å€¼ä¼šè¢«è®¤å®šä¸ºæ–°å»ºäº†å±€éƒ¨å˜é‡ 1234for i=10,1,-1 do print(i) local i=1end breaké€šè¿‡breaké€€å‡ºå¾ªç¯ 1234for i=10,1,-1 do print(i) if i == 5 then break endend whileå¾ªç¯12345n = 10while n&gt;1 do print(n) n = n - 1end repeatå¾ªç¯å’Œwhileå¾ªç¯åŸºæœ¬ä¸€è‡´ å¤šæ–‡ä»¶è°ƒç”¨requireå’Œimportçš„åŒºåˆ«requireå®ç°æ¢ä¸ªç›®å½•åå°±éœ€è¦å¯¹è·¯å¾„è¿›è¡Œå˜æ›´ ä¸ªäººç†è§£ï¼šç»å¯¹è·¯å¾„ 12345local MyClassBase = require(\"app.classes.MyClassBase\")local MyClass = class(\"MyClass\", MyClassBase)local Data1 = require(\"app.classes.data.Data1\")local Data2 = require(\"app.classes.data.Data2\") importå®ç°åœ¨æ¨¡å—åå‰æ·»åŠ å¤šä¸ªâ€.â€ ï¼Œè¿™æ · import() ä¼šä»æ›´ä¸Šå±‚çš„ç›®å½•å¼€å§‹æŸ¥æ‰¾æ¨¡å—ã€‚ ä¸ªäººç†è§£ï¼šç›¸å¯¹è·¯å¾„ 12345local MyClassBase = import(\".MyClassBase\")local MyClass = class(\"MyClass\", MyClassBase)local Data1 = import(\".data.Data1\")local Data2 = import(\".data.Data2\") requireè¿è¡ŒæŒ‡å®šå¤šæ–‡ä»¶ æœ«å°¾ä¸å¸¦æ‰©å±•å 12--.\\?lua æŠŠæ–‡ä»¶ååŒ¹é…åˆ°ï¼Ÿå†…require(\"æ–‡ä»¶å\") ä¸åŒå±‚æ¶æ–‡ä»¶å¤¹ç”¨.åˆ†éš” 1require(\"æ–‡ä»¶å¤¹å.æ–‡ä»¶å\") åªä¼šè¿è¡Œä¸€æ¬¡ 12345678--luaæ–‡ä»¶æœ‰å¯ä»¥returnè¿”å›å€¼local r = require('hello')--åé¢è°ƒç”¨çš„éƒ½æ˜¯å‰é¢è¿”å›çš„å†…å®¹require('hello')require('hello')require('hello')require('hello')print(r) package.path12package.path=package.path..\";./path/?.lua\"require('hello2') å¤šæ¬¡è°ƒç”¨è°ƒç”¨luaæ–‡ä»¶å†…çš„å‡½æ•° 123456789101112--hello.lualocal hello={}function hello.say() print(\"hello world\")end//é€šè¿‡è¿”å›tablereturn hello--test.lualocal test=require('hello')//é€šè¿‡tableå†…çš„æ–¹æ³•è°ƒç”¨test.say() è¿­ä»£table1234t={\"a\",\"b\",\"c\",\"d\"}for i=1,#t,do print(i,t[i])end è¿­ä»£å™¨ipairsçº¯æ•°å­—è¿ç»­ä¸‹æ ‡å¯ä»¥ç”¨ 12345t={\"a\",\"b\",\"c\",\"d\"}--ä¸‹æ ‡ç»™iï¼Œå€¼ç»™jfor i,j in ipairs(t) do print(i,j)end 1234567891011t={ [1]=\"a\", [2]=\"b\", [3]=\"c\", [5]=\"d\"}--ä¸‹æ ‡ç»™iï¼Œå€¼ç»™jfor i,j in ipairs(t) do --åªèƒ½éå†åˆ°1åˆ°3ï¼Œä¸è¿ç»­çš„åé¢éå†ä¸åˆ° print(i,j)end è¿­ä»£å™¨pairså¯ä»¥éå†æ‰€æœ‰ä¸‹æ ‡ pairså†…éƒ¨è°ƒç”¨çš„æ˜¯nextå‡½æ•° 1234567891011t={ [1]=\"a\", [2]=\"b\", [3]=\"c\", [5]=\"d\"}--ä¸‹æ ‡ç»™iï¼Œå€¼ç»™jfor i,j in pairs(t) do --åªèƒ½éå†åˆ°1åˆ°3ï¼Œä¸è¿ç»­çš„åé¢éå†ä¸åˆ° print(i,j)end 1234567891011t={ apple=\"a\", banana=\"b\", eraser=\"c\", water=\"d\"}--ä¸‹æ ‡ç»™iï¼Œå€¼ç»™jfor i,j in pairs(t) do --åªèƒ½éå†åˆ°1åˆ°3ï¼Œä¸è¿ç»­çš„åé¢éå†ä¸åˆ° print(i,j)end å…ƒè¡¨ã€å…ƒæ–¹æ³•è¯­æ³•ç³–12345678t={ a=0, add=function(tab,num) tab.a=tab.a+num end}--ç±»ä¼¼äºé¢å‘å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨t:add(10)--ç­‰ä»·äºt.add(t,10) é¢å‘å¯¹è±¡123456789101112131415161718192021222324--å¯¹è±¡åbag={}bagmt={ --è£…å…¥ä¸œè¥¿çš„å‡½æ•° put=function(t,item) table.insert(t.items,item) end, take=function(t) return table.remove(t) end, list=function(t) return table.concat(t.items,\",\") end}bagmt[\"__index\"]=bagmt--æ„é€ å‡½æ•°function bag.new() local t={ items={} } setmetatable(t,bagmt) return tend åç¨‹coroutineä¸€ä¸ªluaè™šæ‹Ÿæœºé‡Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ coroutine.create å¯åˆ›å»ºä¸€ä¸ªåç¨‹è¿”å›å€¼ä¸º thread ç±»å‹ 123456local co=coroutine.create( function() print(\"hello world!\") end )","categories":[{"name":"ç¼–ç¨‹è¯­è¨€ç¯‡","slug":"ç¼–ç¨‹è¯­è¨€ç¯‡","permalink":"http://ysich.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%AF%87/"}],"tags":[{"name":"Lua","slug":"Lua","permalink":"http://ysich.github.io/tags/Lua/"}]}],"categories":[{"name":"æ¡†æ¶ç¯‡","slug":"æ¡†æ¶ç¯‡","permalink":"http://ysich.github.io/categories/%E6%A1%86%E6%9E%B6%E7%AF%87/"},{"name":"èµ„æºç®¡ç†ç¯‡","slug":"èµ„æºç®¡ç†ç¯‡","permalink":"http://ysich.github.io/categories/%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%AF%87/"},{"name":"ç¼–ç¨‹è¯­è¨€ç¯‡","slug":"ç¼–ç¨‹è¯­è¨€ç¯‡","permalink":"http://ysich.github.io/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%AF%87/"}],"tags":[{"name":"CallBack","slug":"CallBack","permalink":"http://ysich.github.io/tags/CallBack/"},{"name":"Manager æ¡†æ¶","slug":"Manager-æ¡†æ¶","permalink":"http://ysich.github.io/tags/Manager-%E6%A1%86%E6%9E%B6/"},{"name":"èµ„æºç®¡ç†","slug":"èµ„æºç®¡ç†","permalink":"http://ysich.github.io/tags/%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/"},{"name":"Lua","slug":"Lua","permalink":"http://ysich.github.io/tags/Lua/"}]}